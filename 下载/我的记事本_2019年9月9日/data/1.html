<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=gb18030" /><meta http-equiv="cache-control" content="no-cache"><meta http-equiv="expires" content="mon, 22 jul 2002 11:12:01 GMT"><meta http-equiv="pragma" content="no-cache"><title>QQ邮箱 - </title><style type="text/css">body {margin:0;padding:0;font:normal 12px Verdana;}.leftpanel {position:absolute;top:0;left:0;width:180px;height:100%;overflow:auto;padding:0 5px 0 8px;background:#f2f7fc;}.leftpanel ul {padding:8px 0 8px 8px;margin:0;}.leftpanel ul li {white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:140px;margin:0 0 6px 0;list-style:none;}.rightpanel {width:auto!important;width:;height:100%;padding:0 8px 0 8px;}a {color:#039}.rightpanel a {display:block;margin-top:6px;}.bold {font-weight:bold;border-bottom:2px solid #aac1de;padding:11px 0 3px 0}.noteshod {background:#fff;}.notetitle {padding:14px 0 0 14px;margin:0;width:94%!important;width:/**/99%;overflow-x:hidden;}.timesep {margin:3px 0 0 14px;font-size:12px}.mycontent {margin:5px 14px 8px 14px;width:94%!important;width:/**/99%;height:auto!important;height:/**/120px;overflow-x:hidden;word-break:break-all;min-height:120px;line-height:160%}.mycontent div,.mycontent p,.mycontent td,.mycontent font {line-height:160%}.bigfont {font-size:14px;}.nomail {border:1px solid #fff;padding:4px 11px 3px 17px;text-align:right;height:20px;line-height:18px;}.graytext {color:#a0a0a0}.qqshowbd {border:2px solid #aac1de;}</style></head><body><!-- script language="javascript">function S(id){ return document.getElementById(id);}function folderCatalog(catid){var o = S("sp_" + catid);if(o) {var dat = [["－","block"],["＋","none"]];var idx= (o.style.display=="none" ? 0 : 1);o.style.display=dat[idx][1];S("flag_" + catid).innerHTML = dat[idx][0];}}</script onclick="return folderCatalog('')" --><!-- span id="flag_">－</span --><div class="rightpanel"><a name="_52"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>9.4 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年9月4日(星期三) 晚上06:00</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天主要是实现了TP的bring up.</div><div>早上主要是编译BP,按照是上面的流程,把代码写好.开始出错,没有编译进去.所以没有出现后面提示的的编译错误提示.自己看getevent -l才发现没有这个设备.</div><div>下午我用自己的数据线连了串口线,我还以为是同样type -c usb线.主要是没有区分这两个.今天才有所区分.后面又和强哥去领了这个线.自己又学了用minicom来打log.保存log这些.</div><div>整个过程还是比较顺利.就是最后,教程上的三个bug.自己遇到一个,一个是没有出现,一个是这个板子实现不了.按关机这个按钮不会休眠.</div><div>对于这个教程(TP):</div><div>我感觉写的已经可以了.没什么可添加了.按照这个教程,只要步骤不出错,应该可以看到消息的.</div><div>对于没什么基础的:</div><div>1.追加patch,不知道这个patch文件在patch文件夹里(只说了那个文件有什么作用,没说在patch目录下)</div><div>2.打log,不知道怎么连线.</div><div><br  /></div><div>总的感觉,还是需要一些的知识,来做这个会轻松一点.</div><note_content></note_content></div></div><a name="_51"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>9.3 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年9月3日(星期二) 晚上06:21</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div><font color="#333333" face="Arial, sans-serif"><div>今天主要是看了783的LCD的一些代码,后面丁老师又分配这个小白鼠的实践,两个学长或者学姐整理得还是很好的,自己大致看来一遍.:</div><div>1.TouchPanel BringUp流程</div><div>2.Display BringUp流程</div><div>大致了解一些.整编比较慢,到现在都还没有编译完.后面自己又学习一些数据结构的知识.</div><div>感觉还是这个比较好,比看代码好多了.可以让自己动手实践.看到很多的打印消息.</div><div>又看来repo这个,没用过,还是不熟悉.</div><div><br  /></div></font></div><note_content></note_content></div></div><a name="_50"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>浙江华东工程数字技术有限公司 9</b></div><div class="graytext timesep"><span>创建时间：2019年9月3日(星期二) 上午10:09</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>浙江华东工程数字技术有限公司 9.3&nbsp; 邮箱投递 c++开发</div><div>同花顺 1780810607@qq.com&nbsp; liyingfei42118&nbsp; c++开发</div><div>招银网络科技&nbsp; liyingfei42118&amp; c++开发</div><div>锐捷网络公司&nbsp; &nbsp; 2020校招-软件开发工程师（本科）-福州(J15936) 福建省-福州市</div><div>中国邮政储蓄银行股份有限公司</div><div>中移物联网 嵌入式开发</div><note_content></note_content></div></div><a name="_49"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>9.2 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年9月2日(星期一) 晚上06:16</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天主要是整理了LCD亮灭屏的代码分析:</div><div><div>1.背光注册流程</div></div><div>2.注册 backlight&nbsp; sys节点及set函数实现</div><div>3.背光:mdss_fb_set_backlight()</div><div><div>4.显示:mfd-&gt;mdp.off_fnc(mfd);&nbsp;</div></div><div><div>5.开关panel电源</div></div><div><div>6.开关panel</div></div><div>顺着网上的教程在783代码里找了一遍,随着层层深入,感觉好复杂.理解还是理解了一部分.如果把整函数看了,感觉难的还是他们的联系.</div><div><br  /></div><div><br  /></div><note_content></note_content></div></div><a name="_48"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.30 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月30日(星期五) 晚上06:02</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天主要是看了LCD,找到文件在哪里,还有设备树的一些节点.最重要的还是明白了LCD的三个部分和亮屏灭屏,还有部分函数:</div><div>LCD相关code所在目录：</div><div><div>&nbsp; &nbsp; &nbsp; &nbsp; kernel/drvier/video/msm/fbdev/&nbsp;</div><div>软件驱动主要分为三部分：</div><div>&nbsp; &nbsp; &nbsp; &nbsp; MDP 驱动</div><div>&nbsp; &nbsp; &nbsp; &nbsp; DSI 控制器驱动</div><div>&nbsp; &nbsp; &nbsp; &nbsp; FrameBuffer驱动</div><div>执行probe 的先后顺序：</div><div>&nbsp; &nbsp; &nbsp; &nbsp;MDP probe →&nbsp; DSI probe → FB probe</div><div>MDP probe：对使用的硬件资源进行初始化，同时在fb设备中注册mdp的使用接口</div></div><div><div>DSI probe：解析模组厂提供的panel的dtsi文件，从文件中获得panel的mode，分辨率，帧率，command数据等。</div><div>FB probe：从DSI的数据结构中获取到panel的相关信息，多MDP进行初始化。</div></div><div><br  /></div><div><br  /></div><div><div>&nbsp; 在kernel/drivers/video/msm/mdss/mdss_fb.c中，</div><div><br  /></div><div>&nbsp; &nbsp; &nbsp; &nbsp; static intmdss_fb_blank_sub(int blank_mode, struct fb_info *info, int op_enable)&nbsp;&nbsp;</div><div><br  /></div><div>&nbsp; &nbsp; blank_mode这个参数的值主要有两个，FB_BLANK_UNBLANK和 FB_BLANK_POWERDOWN ，</div><div><br  /></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FB_BLANK_UNBLANK是亮屏操作；</div><div><br  /></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FB_BLANK_POWERDOWN 是灭屏操作；</div><div><br  /></div></div><div><br  /></div><div>高通平台LCD模块大致分为两部分：KERNEL和LK。这个遇到,还没有理清.</div><div>还有大致的调用怎么实现还没有理清.</div><div><br  /></div><note_content></note_content></div></div><a name="_47"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.29 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月29日(星期四) 下午05:49</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div style=" color: rgb(0, 0, 0) ; ; ; ;; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; ">今天主要是整理了TP的注册(从原理图对应设备树出发),创建接口节点,及怎么使用的ppt.</div>
<div style=" color: rgb(0, 0, 0) ; ; ; ;; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; ">后面又看了汇顶TP
 的ESD Protect 
Module,感觉还是挺难的,我在783里的TP搜了esd,发现cyttsp5根本一点没涉及,有一个函数倒是涉及,就是不是需要的,我大致看了,要创建结构体,感觉行不通这种方法.想着把汇顶的移植过来.分析一般天,没发现怎么去调用.用的是个条件编译.后面又看了LCD的大致流程,还没有去函数里具体分析.好多东西看着还是挺难的.</div><br  /><note_content></note_content></div></div><a name="_46"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.28 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月28日(星期三) 晚上06:16</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天主要是和惠姐讨论以后该干什么.理清了关于固件升级和休眠功耗超标的问题.虽然没有动手操作过,不过还是可以想象的.</div><div>自己也用gitk看了别人怎么修改TP,发现有些地方还是很难的.惠姐也指导了自己后面该做的事(783项目有个需求是打开Touch/Display的ESD功能,然后总结下Touch的工作流程，跟张艺腾一样做个报告，你们实习结束后是要做分享报告的，后面可以直接在这个报告上面修改).开始不明白display是什么,现在倒是理解了,刚开始,我就觉得TP里面好像没有这个东西.</div><note_content></note_content></div></div><a name="_45"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.27 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月27日(星期二) 下午05:47</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天看汇顶的关于固件升级和电源管理的文件,大部分都看了.其中还有关于提供一些接口来调试的函数.大部分还是看得懂.</div><div>遇到字节对齐这个写法,自己看了相关的资料.以前只知道结构体里面是要对齐的,不知道还有这个专门的设置对齐的.也让我想起了大端方式和小端方式.上个周就听他们讨论,后面忘记整理了.今天整理了一下.</div><div>后面,又看到了get_fs()和 set_fs()这两个函数。就上网搜了,了解了他们在VFS_read()和VFS_write()具体有什么作用.也知道了内核也可以像用户态那样,对文件操作,来实现一些调试.</div><div>还有这两个函数gt1x_load_patch(),gt1x_startup_patch()应该是实现用补丁方式来升级.</div><style type="text/css">@page { margin: 0.79in}
.qmbox p { margin-bottom: 0.1in; line-height: 120% }
.qmbox a:link { so-language: zxx }
}
</style><note_content></note_content></div></div><a name="_44"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.23 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月23日(星期五) 下午05:54</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div><div>今天问了惠姐触摸屏可能出现的问题:i2c不通 、跳点、卡点、不报点、点偏移、休眠功耗超标、固件升级</div></div><div>今天主要是分析了下面几个,给出了流程:</div><div><img src="https://p.qlogo.cn/qqmail_head/7EE50N9YAPOf4EDnzWMTOxYIhicPYtqswLfkMDrkLBcWUoes7iaOAqL5qWgicMpQmibC6uXW2GjCFibk/0" modifysize="68%" diffpixels="14px" style="width: 677px; height: 423px;"  /></div><div><br  /></div><div>跳点、卡点、不报点、点偏移(数据上报出现)</div><div><br  /></div><div><img src="https://p.qlogo.cn/qqmail_head/7EE50N9YAPOf4EDnzWMTOxYIhicPYtqswLfkMDrkLBcXyDG6N936PvnXpf1ltO2RxwXLzphmpjv0/0" modifysize="57%" diffpixels="10px" style="width: 632px; height: 291px;"  /></div><div><br  /><br  /></div><note_content></note_content></div></div><a name="_43"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.22 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月22日(星期四) 晚上06:04</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content>今天主要是看了dmesg命令和cat /proc/kmsg有所不同:<div><div>(1) dmesg命令</div><div>每次使用,都会打印出环形缓冲区的所有信息</div><div>&nbsp;(2)cat /proc/kmsg</div><div>只会打印出每次新的环形缓冲区的信息</div></div><div>(3)后面测试网上模拟制作环形缓冲区的代码,报错:(make)</div><div><div>/home/ts/learn_archive/dmesg/mykmsg.c:9:32: fatal error: asm/arch/regs-gpio.h: No such file or directory</div><div>compilation terminated.</div></div><div>(4)解决思路:linux版本问题,</div><div>(5)用find -name regs-gpio.h来解决:</div><div><a href="https://blog.csdn.net/u012444155/article/details/20219879">https://blog.csdn.net/u012444155/article/details/20219879</a></div><div>我自己查的:</div><div><div>./usr/src/linux-headers-4.10.0-28/arch/arm/mach-ks8695/include/mach/regs-gpio.h</div><div>./usr/src/linux-headers-4.10.0-28/arch/arm/mach-s3c24xx/include/mach/regs-gpio.h</div><div>./usr/src/linux-headers-4.10.0-28/arch/arm/mach-s3c64xx/include/mach/regs-gpio.h</div><div>./usr/src/linux-headers-4.10.0-28/arch/unicore32/include/mach/regs-gpio.h</div></div><div>修改之后也报错:</div><div><div>/home/ts/learn_archive/dmesg/mykmsg.c:9:28: fatal error: mach/regs-gpio.h: No such file or directory</div><div>compilation terminated.</div></div><div><br  /></div><div>后面又看了i2c的驱动,也是这个人的博客,主要是看了发送信息这个:i2c_msg</div><div>读操作需要两个i2c_msg,写操作需要一个i2c_msg,是因为读IIC设备是两个流程(有一篇专门介绍I2C通信,里面有时序图)</div><div><br  /></div><note_content></note_content></div></div><a name="_42"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.21 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月21日(星期三) 下午05:42</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天上午主要是继续昨天的支持阻塞操作和轮询操作的globalfifo设备驱动代码分析,结合书上的分析,自己测试.</div><div>下午又继续测试gloablfifo基础上添加异步通知,不过没有测试成功.后面看了书上Linux设备驱动的软件架构思想(大致意思就是把设备与驱动隔离,用platform总线来将他们联系起来).</div><div>又看了关于Input子系统与TP驱动 ,这是一篇介绍的很详细的CSDN博客,通过代码分析了下面四个部分的具体内容:(分析很详细,基本都是结合具体的代码分析)</div><div><div>(1)层级结构(三者怎么实现接口)</div><div><div>Input子系统分为三个层级：</div><div>事件处理层：evdev.c 、joydev.c、mousedev.c</div><div>核心层：input.c</div><div>设备驱动层：touchscreen、mouse、fingerprint 等</div><div><br  /></div><div>事件处理层：通过核心层的API获取输入事件上报的数据，定义API与应用层交互</div><div>核心层：为事件处理层和设备驱动层提供接口API</div><div>设备驱动层：采集输入设备的数据信息，通过核心层提供的API上报数据</div><div><br  /></div></div><div>(2)基础数据结构(三者怎么交互)</div><div><div>struct input_dev：会在具体设备驱动层中被填充</div><div>struct input_handle：会在事件处理层和设备驱动层注册设备时通过input_dev或input_handler间接调用</div><div>struct input_handler：会在事件处理层如evdev.c中被实例化</div></div><div><br  /></div><div>(3)事件上报流程:input.c等代码</div><div>(4)设备驱动层:具体驱动的加载</div></div><div>网址:</div><div><a href="https://blog.csdn.net/u014545515/article/details/53507567">https://blog.csdn.net/u014545515/article/details/53507567</a></div><note_content></note_content></div></div><a name="_41"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.20 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月20日(星期二) 晚上06:13</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天主要是看书,并且实现书上的代码:</div>
    <div>(1)字符驱动实例globalmem</div>
    <div>(2)支持阻塞操作和轮询操作的globalfifo设备驱动</div>
    <div>遇到的问题是,书上的代码和网上的代码有许多的错误,大部分是版本低,有一些库函数里面已经更新,换了写法.自己修改了,成功运行.</div>
    <div>学到了内核与用户空间的交互关系:copy_to_user
、copy_from_user函数实现内核空间数据与用户空间数据的相互访问,以及理解了makefile里怎么去编译这个函数,以前还是很模糊的.感觉这个对我们看驱动里创建节点以及文件管理这些有很好的帮助.</div><note_content></note_content></div></div><a name="_40"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.19 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月19日(星期一) 晚上06:03</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天主要是总体的看了触摸屏驱动的加载流程分析与移植,网上有一篇CSDN博客专门介绍这个的,上面的也是基于高通的这个汇顶的TP的分析.感觉和自己看的这个代码其实差不多,自己主要是根据他介绍的,自己又走了一下流程.</div><div>下面是网页链接:</div><div><a href="https://blog.csdn.net/qq_23327993/article/details/83501702">https://blog.csdn.net/qq_23327993/article/details/83501702</a></div><div><br  /></div><div>下午有看了书上的专门介绍字符设备驱动这一章,又在网上找了一个也是基于ubuntu的编写,自己也测试了,成功运行了.不过,还需要多分析一下,大部分用到了今天所看的知识.这个还是是涉及用户空间和内核的.(实现一个名字为 blackhole 的设备:从该设备读不到任何数据,却可以写入任意多的数据。)</div><div>下面是网页链接:</div><div><a href="https://blog.csdn.net/sinat_26599509/article/details/51158628">https://blog.csdn.net/sinat_26599509/article/details/51158628</a></div><div><div class="article-info-box" style=" box-sizing: inherit; outline: 0px; margin: 0px; padding: 0px 0px 14px; position: relative; color: rgba(0, 0, 0, 0.75); ; ; ; ; ; ; ; ; ; ; ; "></div></div><note_content></note_content></div></div><a name="_39"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.16 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月16日(星期五) 晚上06:06</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天主要是看了汇顶的代码(785),看了之后,感觉真的比783的简单好多.层次比较清晰,并且每个函数都有备注.联系前面看的,感觉思路,比全面清晰多了.自己也看了设备树和原理图,按照以前的方法,找了一下对应的东西.看了之后,印象最深的还是关于slot的协议和创建节点的方法.</div>
    <div>后面又看了内核通知链相关的知识和中断,中断主要是在书上看的(中断的区分,还有仔细的看了进程上下文,中断上下文).还有自旋锁这些.</div><note_content></note_content></div></div><a name="_38"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.15 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月15日(星期四) 晚上06:21</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天主要是解决了昨天的疑惑:</div><div>(1) B协议又称为slot协议，那么input子系统里面使用的slot是什么，A/B协议究竟是如何划分的？</div><div>&nbsp; &nbsp; &nbsp; slot直译为位置、槽，有两层含义，一层是位置，另一层是容器。在Input子系统中，它扮演的就是这两个角色。它产生于这样一个背景：</div><div>&nbsp; &nbsp; &nbsp; 如果从Device获取的当前数据与上一个数据相同，我们有必要再上报当前数据吗？如果我们不管两次数据是否一致都上报，那就是A协议；如果我们选择不上报，那么既然需要比较，总需要把上一次数据存起来吧，slot就是做这个事情的，显然这就是Slot(B)协议。(他们上报数据的方式有所差别)</div><div>(2)今天算是成功安装了qq和微信,虽然有瑕疵.使用</div><note_content></note_content></div></div><a name="_37"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.14 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月14日(星期三) 晚上06:27</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天主要是看了input-mt.c,因为昨天才了解了mt这个缩写的意思.以前看触摸屏驱动的时候,网上的教程都都介绍input目录下有专门驱动事件处理(tsdev.c).在看783的时候看了,我就很奇怪没有.今天才真正的发现有这个.所以今天就主要是看了这个.有些疑问的是slots怎么理解,网上说是关于触摸屏属性的设置.</div><div>&nbsp;* input_mt_init_slots() - initialize MT input slots</div><div>&nbsp;* @dev: input device supporting MT events and finger tracking</div><div>&nbsp;* @num_slots: number of slots used by the device</div><div>&nbsp;* @flags: mt tasks to handle in core</div><div><br  /></div><div><img src="https://images2017.cnblogs.com/blog/1182576/201710/1182576-20171005101119911-1343876.png" modifysize="80%" diffpixels="18px" style="width: 529px; height: 240px;"  /></div><div>下午又打算安装微信和qq.用crossover来安装,只有15天的使用期,倒是成功了.无法破解,网上的破解文件都被限制了.后来又试了wine来安装.qq安装成功了.就是最小化之后,鼠标到那个最小化的图标被隐藏了.应该是ubuntu不支持的原因.安装其他的,也没有成功,百度网盘,微信这些出错.</div><note_content></note_content></div></div><a name="_36"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.13  实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月13日(星期二) 晚上06:20</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>
	
	
	<style type="text/css">@page { margin: 0.79in }
.qmbox p { margin-bottom: 0.1in; line-height: 120% }
}
</style>


<p style="margin-bottom: 0in; line-height: 100%">今天主要是解决了自己一些理解上的问题:(1,4)</p><p style="margin-bottom: 0in; line-height: 100%">看书:(2,3)</p><p style="margin-bottom: 0in; line-height: 100%"> 1. rc =
cyttsp5_mt_probe(dev);//<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">触摸屏</span></font></font></p>
<p style="margin-bottom: 0in; line-height: 100%">        if (rc &lt;
0) {</p>
<p style="margin-bottom: 0in; line-height: 100%">               
dev_err(dev, "%s: Error, fail mt probe\n", __func__);</p>
<p style="margin-bottom: 0in; line-height: 100%">                goto
error_startup;</p>
<p style="margin-bottom: 0in; line-height: 100%">        }</p>
<p style="margin-bottom: 0in; line-height: 100%"><br  />

</p>
<p style="margin-bottom: 0in; line-height: 100%">        rc =
cyttsp5_btn_probe(dev);//<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">按键</span></font></font></p>
<p style="margin-bottom: 0in; line-height: 100%">        if (rc &lt;
0) {</p>
<p style="margin-bottom: 0in; line-height: 100%">               
dev_err(dev, "%s: Error, fail btn probe\n", __func__);</p>
<p style="margin-bottom: 0in; line-height: 100%">                goto
error_startup_mt;</p>
<p style="margin-bottom: 0in; line-height: 100%">        }</p>
<p style="margin-bottom: 0in; line-height: 100%"><br  />

</p>
<p style="margin-bottom: 0in; line-height: 100%">        rc =
cyttsp5_proximity_probe(dev);//<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">？检测物体接近</span></font></font>,<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">一般关闭</span></font></font></p>
<p style="margin-bottom: 0in; line-height: 100%">        if (rc &lt;
0) {</p>
<p style="margin-bottom: 0in; line-height: 100%">               
dev_err(dev, "%s: Error, fail proximity probe\n",
__func__);</p>
<p style="margin-bottom: 0in; line-height: 100%">                goto
error_startup_btn;</p>
<p style="margin-bottom: 0in; line-height: 100%">        }</p>
<p style="margin-bottom: 0in; line-height: 100%">2.driver<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">目录下的</span></font></font>Kconfig,<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">在</span></font></font>arch/arm64<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">下被引用</span></font></font></p>
<p style="margin-bottom: 0in; line-height: 100%"><br  />

</p>
<p style="margin-bottom: 0in; line-height: 100%">3.<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">在</span></font></font>linux<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">内核中</span></font></font>,<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">使用</span></font></font>cdev<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">结构体描述一个字符设备</span></font></font>.<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">其中</span></font></font>dev_t<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">成员定义了设备号</span></font></font>.<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">为</span></font></font>32
<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">位</span></font></font>.<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">其中</span></font></font>12<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">为主设备号</span></font></font>,20<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">位为次设备号</span></font></font>.<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">使用下面宏获得主设备号和次设备号</span></font></font>.</p>
<p style="margin-bottom: 0in; line-height: 100%">MAJOR(dev_t dev)</p>
<p style="margin-bottom: 0in; line-height: 100%">MINOR(dev_t dev)</p>
<p style="margin-bottom: 0in; line-height: 100%">MKDEV(int major, int
minor)<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">通过主设备号和次设备号</span></font></font>.<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">生成</span></font></font>dev_t.</p>
<p style="margin-bottom: 0in; line-height: 100%"><br  />

</p>
<p style="margin-bottom: 0in; line-height: 100%">4.</p>
<p style="margin-bottom: 0in; line-height: 100%">static void
cyttsp5_mt_send_dummy_event(struct cyttsp5_core_data *cd,</p>
<p style="margin-bottom: 0in; line-height: 100%">               
struct cyttsp5_mt_data *md)</p>
<p style="margin-bottom: 0in; line-height: 100%">//?dummy
<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">并没有什么意思</span></font></font>,<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">虽然很多地方都用到</span></font></font>,<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">具体要看函数的作用</span></font></font>.</p>
<p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">在这个函数中定义了一些手势的作用</span></font></font>,<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">用来唤醒屏幕等这些操作</span></font></font>.<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">主要还是自己没有理解手势</span></font></font>(gesture)<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">的意义</span></font></font>.<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">我开始的理解都是</span></font></font>,<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">屏工作着</span></font></font>,<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">手势是远离屏幕的</span></font></font>.<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">据惠姐的指点</span></font></font>,<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">才意识到像双击唤醒屏幕也属于手势</span></font></font>.</p>
<p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">大部分这里想通了</span></font></font>,<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">下面有好几个函数</span></font></font>(<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">关于屏幕休眠与手势</span></font></font>)<font face="Noto Sans CJK SC Regular"><font size="2" style="font-size: 10pt"><span lang="zh-CN">也想清楚了</span></font></font>.</p><br  /></div><note_content></note_content></div></div><a name="_35"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.12 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月12日(星期一) 晚上06:15</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天主要是看getevent -l /dev/input/event2，这个怎么在驱动里怎么上报数据。意思就是这些坐标怎么产生。现在还在不怎么清楚具体的流程。</div><div>其他的，就是弄明白了LCM背光是什么东西。还有就是git上传东西到github上居然有大小限制。用升级的工具，也有一定大小的限制，后面用多了，还要钱来继续扩充容量。赚钱的方法无处不在啊。</div><note_content></note_content></div></div><a name="_34"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.9 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月9日(星期五) 晚上06:31</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天感觉是这周收获最多的一天。很多迷迷糊糊的问题，都理清了。</div><div>早上和惠姐讨论了代码编译和烧录的问题。下午又讨论了接口文件路径的问题。还有丁老师们的讨论与解决问题，需要去了解交叉编译这个东西。</div><div>最重要的是感觉很多不怎么清晰的问题，现在清晰了很多。有些尴尬的问题是，那个关于触摸屏节点的创建，是被创建好的。今天在找中断的时候，才发现。他创建的方法和我们看led的有些不一样。还有函数名没那么明显。但我追踪函数时，其实后面实现都是一样的。</div><div>最后，自己又连接板子，试了一下。（<span style=" background-color: rgb(245, 245, 245); font-size: 9pt; ; ; ; ; ">getevent /dev/input/</span><font face="Courier New" style="background-color: rgb(245, 245, 245); font-size: 9pt; text-align: justify; white-space: pre-wrap;"><span style="display: inline-block; border: none; padding: 0in">event2</span></font>）点击屏幕，出现坐标。也利用别人实现好的接口（drv_irq)，实现把触摸屏给关闭了。我自己在实现这个接口的时候，我的思路是找中断，然后关中断。想得简单了。别人实现的（需要判断当前状态，然后用锁机制，后面屏蔽中断（这个前面也看见到这个函数，就是没理解））</div>
	
	
	<style type="text/css">@page { margin: 0.79in }
.qmbox pre.cjk { font-family: "Nimbus Mono L", monospace }
.qmbox p { margin-bottom: 0.1in; line-height: 120% }
.qmbox a:link { so-language: zxx }
}
</style><note_content></note_content></div></div><a name="_33"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>总结</b></div><div class="graytext timesep"><span>创建时间：2019年8月8日(星期四) 中午01:39</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>这个月学了很多的东西（led、input、i2c、suspend、resume、Kconfig、makefile、git），就是用的时候不知道怎么联系起来。感觉还是挺难的。我感觉难的地方是看代码，好多的东西不懂。和自己看的联系不起来。</div><div>几个周了，感觉没有什么进步。</div><note_content></note_content></div></div><a name="_32"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.7 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月7日(星期三) 晚上06:17</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><p>今天主要是尝试着写这TOUCH_LOCK，想着先试试能不能输出什么信息。不过到后面用make bootimage -j32编的时候，就报错，自己修改了好多地方也没有改对。前面写的led的suspend和resume也没有对。回退工作区的修改，倒是编译通过了。<br  />
</p><p>打算明天再试试，准备先尝试函数能编译通过，在想办法实现里面的内容。</p><p>下面是我的修改：</p><p>static char mybuf[100] = "open";</p><p><br  /></p><p>static ssize_t cyttsp5_open_store(struct device* dev, struct device_attribute *attr,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const char* buf, size_t len)</p><p>{</p><p>&nbsp; &nbsp; &nbsp; &nbsp; struct cyttsp5_core_data *cd;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; cd-&gt;dev = dev;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; cyttsp5_release(cd);/找到一个/错误在这里，后面才定义</p><p>&nbsp; &nbsp; &nbsp; &nbsp; sprintf(mybuf, "%s", buf);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; return len;</p><p>}</p><p>static ssize_t cyttsp5_open_show(struct device* dev, struct device_attribute *attr, char* buf)</p><p>{</p><p>&nbsp; &nbsp; &nbsp; &nbsp; return sprintf(buf, "%s\n", mybuf);</p><p>}</p><p>static DEVICE_ATTR(TOUCH_LOCK, S_IWUSR|S_IRUSR, cyttsp5_open_show, cyttsp5_open_store);</p><p><br  /></p><p>static struct attribute *touch_attributes[] = {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &amp;dev_attr_TOUCH_LOCK,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; NULL</p><p>};</p><p><br  /></p><p>static struct attribute_group touch_attribute_group = {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; .attrs = touch_attributes####################################################</p><p>};</p><p>int cyttsp5_probe(const struct cyttsp5_bus_ops *ops, struct device *dev,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u16 irq, size_t xfer_buf_size)</p><p>{</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /*my create sysfs**************************************************/</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ret = sysfs_create_group(cd-&gt;dev-&gt;kobj, &amp;touch_attribute_group);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if(ret){</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;printk("######################################33####################################################Touch_LOCK");</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>}</p><div><br  /></div><br  /><br  /><note_content></note_content></div></div><a name="_31"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>数据库学习</b></div><div class="graytext timesep"><span>创建时间：2019年8月7日(星期三) 上午09:32</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div><span style=" color: rgb(51, 51, 51); ; ; ">并发操作带来的数据不一致性包括丢失修改、不可重复读、读“脏”数据</span></div><div><span style=" color: rgb(51, 51, 51); ; ; ">脏读就是指当一个</span><a href="https://baike.baidu.com/item/%E4%BA%8B%E5%8A%A1" target="_blank" style=" text-decoration-line: none; color: rgb(37, 187, 155); ; ; ">事务</a><span style=" color: rgb(51, 51, 51); ; ; ">正在访问数据，并且对数据进行了修改，而这种修改还没有提交到数据库中，这时，另外一个事务也访问这个数据，然后使用了这个数据。因为这个数据是还没有提交的数据，那么另外一个事务读到的这个数据是</span><a href="https://baike.baidu.com/item/%E8%84%8F%E6%95%B0%E6%8D%AE" target="_blank" style=" text-decoration-line: none; color: rgb(37, 187, 155); ; ; ">脏数据</a><span style=" color: rgb(51, 51, 51); ; ; ">，依据脏数据所做的操作可能是不正确的。</span></div><note_content></note_content></div></div><a name="_28"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.6 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月6日(星期二) 晚上06:19</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天，在惠姐的建议和丁老师的讲解下，主要是解决了昨天的一些困惑(Makefile,Kconfig,.config的联系不清楚)。联系以前的一些知识和今天的看的资料，也发现自己还是有很多的不足。虽然很多的东西看是看过了，但是没理解清楚。一到用的时候就想不到他们的联系了。以后看的时候需要多理解理解。明天也准备仿照leds尝试写touch_lock节点。</div><note_content></note_content></div></div><a name="_24"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.5  实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月5日(星期一) 晚上06:37</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div><div class="moz-text-flowed" style="font-family: -moz-fixed; font-size: 12px;" lang="x-unicode">今天主要是根据惠姐的建议，自己看了cyttsp5相关的内容。和看aw9106一样，看具体的注册等方面，并联系设备树这些看了一下。还有就是疑惑的touchscreen目录下，cyttsp5应该是控制783的触摸屏的，其他的一些文件有什么作用呢？
<br  />
<br  />还有惠姐，你早上说的，创建touch_lock节点具体是什么意思？（是不是类似用DEVICE_ATTR()实现这个？）
<br  />
<br  />后面有看来led的suspend和resume，发现自己上次做的是错的。今天看来其他类似的，不过还是有问题。
<br  />
<br  />例如下面这个：
<br  />
<br  />#ifdef CONFIG_PM_SLEEP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //这个宏控没有定义（我自己搜了） 
，好多文件里都用到了。应该是定义在./arm64/configs目录下，其中怎么发挥作用，还不怎么清楚
<br  />
<br  />static int bd2802_suspend(struct device *dev)
<br  />{
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struct i2c_client *client = to_i2c_client(dev);
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struct bd2802_led *led = i2c_get_clientdata(client);
<br  />
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gpio_set_value(led-&gt;pdata-&gt;reset_gpio, 0);
<br  />
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;
<br  />}
<br  />
<br  />static int bd2802_resume(struct device *dev)
<br  />{
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struct i2c_client *client = to_i2c_client(dev);
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struct bd2802_led *led = i2c_get_clientdata(client);
<br  />
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!bd2802_is_all_off(led) || led-&gt;adf_on) {
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bd2802_reset_cancel(led);
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bd2802_restore_state(led);
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
<br  />
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;
<br  />}
<br  />#endif
<br  />
<br  />static SIMPLE_DEV_PM_OPS(bd2802_pm, bd2802_suspend, bd2802_resume);
<br  />
<br  />static const struct i2c_device_id bd2802_id[] = {
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { "BD2802", 0 },
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { }
<br  />};
<br  />MODULE_DEVICE_TABLE(i2c, bd2802_id);
<br  />
<br  />static struct i2c_driver bd2802_i2c_driver = {
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .driver = {
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .name&nbsp;&nbsp; = "BD2802",
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .pm&nbsp;&nbsp;&nbsp;&nbsp; = &amp;bd2802_pm,
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .probe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = bd2802_probe,
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .remove&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = bd2802_remove,
<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .id_table&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = bd2802_id,
<br  />};
<br  />
<br  /></div><br  /></div><note_content></note_content></div></div><a name="_22"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.2 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月5日(星期一) 上午09:23</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div><div>今天主要是看了aw9106的具体的怎么驱动（用寄存器，还是直接用引脚）。后面又看来i2c驱动的流程和Linux之输入子系统分析和linux触摸屏驱动。主要是看了input.c文件里的那些函数。依照网上的流程去opengrok里具体的找那些函数。又把自己整理的文件全部放在了github上。</div>
<div>&nbsp;</div>
<div>现在感觉看这些资料，大部分还是懂，就是具体怎么去实现好像很难。</div></div><note_content></note_content></div></div><a name="_20"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>8.1 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年8月1日(星期四) 晚上06:28</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div><p>今天主要是根据丁老师的建议看了内核打印等级、和驱动中创建调用的接口函数，并且在Opengrok搜索了具体的函数。</p>
<p style="margin-bottom: 0in; line-height: 100%">有看来丁老师推荐的关于sysfs。大致了解这个生成路径，不过没找到


	
	
	
	/sys/devices/soc/c1b6000.i2c/i2c-6/6-005b</p>
<p style="margin-bottom: 0in; line-height: 100%">/leds/aw9106_led 这个路径具体怎么生成的。我想应该是被具体的变量替换，所以才没有那么容易找到。今天也收藏和整理了一些东西。感觉看了那么多，就是记不住。只有一个模糊的概念，不是那么的深刻。</p>
<p style="margin-bottom: 0in; line-height: 100%">下午自己也自己写了led的suspend和resume：</p>
<p style="margin-bottom: 0in; line-height: 100%">(1)写函数<br  />
</p>
<p style="margin-bottom: 0in; line-height: 100%">static void aw9106_i2c_suspend(void)<br  />
{<br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pr_info("##########################################################################################33#######\n");<br  />
  <br  />
}<br  />
static void aw9106_i2c_resume(void)<br  />
{<br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
pr_info("#################################################&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;7777777#######\n");<br  />
  <br  />
}</p>
<p style="margin-bottom: 0in; line-height: 100%">（2）添加调用<br  />
</p>
<p style="margin-bottom: 0in; line-height: 100%">static struct i2c_driver aw9106_i2c_driver = {<br  />
&nbsp;&nbsp;&nbsp; .driver = {<br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .name = AW9106_I2C_NAME,<br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .owner = THIS_MODULE,<br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .of_match_table = of_match_ptr(aw9106_dt_match),<br  />
&nbsp;&nbsp;&nbsp; },<br  />
&nbsp;&nbsp;&nbsp; .probe = aw9106_i2c_probe,<br  />
&nbsp;&nbsp;&nbsp; .remove = aw9106_i2c_remove,<br  />
&nbsp;&nbsp;&nbsp; .id_table = aw9106_i2c_id,<br  />
&nbsp;&nbsp;&nbsp; .suspend = aw9106_i2c_suspend,<br  />
&nbsp;&nbsp;&nbsp; .resume = aw9106_i2c_resume,<br  />
};</p>
<p style="margin-bottom: 0in; line-height: 100%">（3）修改i2c结构体<br  />
</p>
<p style="margin-bottom: 0in; line-height: 100%">struct i2c_driver {<br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unsigned int class;<br  />
  <br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* Notifies the driver that a new bus has appeared. You should avoid<br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * using this, it will be removed in a near future.<br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int (*attach_adapter)(struct i2c_adapter *) __deprecated;<br  />
  <br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* Standard driver model interfaces */<br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int (*probe)(struct i2c_client *, const struct i2c_device_id *);<br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int (*remove)(struct i2c_client *);<br  />
  <br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* driver model interfaces that don't relate to enumeration&nbsp; */<br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void (*shutdown)(struct i2c_client *);<br  />
  <br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void (*suspend)(void);<br  />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void (*resume)(void);<br  />
......}<br  />
</p>


<p>编译成功，烧录成功。就是用（dmesg）查看时，日志中没有。我猜想这个应该还要去修改i2c的驱动，相关的资料倒是看了，这个783里面的i2c驱动代码倒是还没有具体看过。</p><br  /></div><note_content></note_content></div></div><a name="_18"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>7. 31 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年7月31日(星期三) 晚上06:40</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><style type="text/css">.qmbox p {}
</style>


<p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">今天主要是几个人合作刷机，尝试了怎么用命令怎么控制相关灯的熄灭。和用</span></font></font>dmesg<font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">查看日志。</span></font></font><font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">和用</span></font></font>dmesg<font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">查看日志。其中还是遇到一些困难，就像这些依赖包对编译、刷机这些影响还是很大的。需要注意。</span></font></font></p>
<p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">没有尝试的是写函数，用
</span></font></font>i2c_driver<font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">这个来调用。自己也整理了一些相关的知识。由于计算机没网，（主要是</span></font></font>IT<font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">上去请了，也没见到下来），还有些需要实践。不过刷机这个倒是会了。明天准备再问问</span></font></font>IT<font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">，然后实践一下这个</span></font></font>suspend<font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">和</span></font></font>resume<font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">。</span></font></font></p>
<p style="margin-bottom: 0in; line-height: 100%"><br  />

</p>
<p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">现在还有问题的是：</span></font></font></p>
<p style="margin-bottom: 0in; line-height: 100%">1.<font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">怎么用常规的方法找到</span></font></font>DEVICE_ATTR
<font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">（）创建接口的文件目录，（意思是找不到用命令控制灯熄灭的文件在那里）：</span></font></font></p>
<p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">我们用</span></font></font>find
-name green_leds<font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">才找到。</span></font></font></p>
<p style="margin-bottom: 0in; line-height: 100%">2.dmesg<font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">查看</span></font></font>log<font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">能不能查看相关的部分，而不是全部打印（这个我明天在仔细看看相关的资料）</span></font></font></p><p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN"><br  /></span></font></font></p><p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><font style="font-size: 10pt" size="2"><span lang="zh-CN">今天最气的是去找IT，发邮箱不回，架子真大。找了两次，一次不在。第二次答应了，不来。真的是，垃圾。浪费了自己的那么多的时间。</span></font></font></p><p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><span style="font-size: 13.3333px;">回想起来，已经浪费很长的时间了。第三周、第二周，这周也是，心里不知不觉有些低沉。自己不知道后面会不会越来越好。可心情却是越来越沉重。自己晚上回来也干不了多少事情。只希望以后的日子能够好好的发展，多学多记记笔记。反正就是学好当前的知识。也不要好高骛远。尽量打好基础。</span></font></p><p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><span style="font-size: 13.3333px;">这也许就是现实，待遇不同。自己感觉还是太嫩了。为什么选择了，还要后悔。好好搞搞。</span></font></p><p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><span style="font-size: 13.3333px;">昨天晚上也是突然没电了，幸好自己有小风扇和充电宝。</span></font></p><p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><span style="font-size: 13.3333px;">晚上自己去食堂买了鸭脖子，真的是，垃圾，浪费钱。害自己又去买零食来吃。</span></font></p><p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><span style="font-size: 13.3333px;">女朋友被蜘蛛咬了，自己也没这么关心。</span></font></p><p style="margin-bottom: 0in; line-height: 100%"><font face="Noto Sans CJK SC Regular"><span style="font-size: 13.3333px;">自己真的是一个有毒的人。</span></font></p><note_content></note_content></div></div><a name="_17"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>7.30 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年7月31日(星期三) 晚上06:39</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content>今天主要是依照惠姐来演示的，看了相关的知识。然后下午领电脑，安装了一些需要的的依赖。并且下载了代码，使用make 
bootimage 
-j32来编译测试还差什么东西。整编时间需要很长，准备留着晚上，给它编译一个晚上。<br  />后来又adb 
devices测试这个板机是否成功。暂时还没有什么太大问题，更多的还是需要后面多实践。 真的越来越失望，对这个公司。这种制度对实习生一点不好，做伪实习生真的不好。第四周才发电脑。也没有专门的导师来指导。虽然形象的分配了一个学姐，感觉用处也有。不过还是感觉没什么大的作用。<div>今天也是嘴欠，说网不急用。真的是IT有什么忙的。分配电脑都不会，检查一个网络都不会。</div><div><br  /></div><div>后记：</div><div>断网，打开邮箱，发现乱码。本来打算保存发到邮箱的，可是没有机会了。</div><div>只能今天发和修改了。</div><div>也非常感谢惠姐的照顾，来到公司对我比较好的吧。其他人也许对自己也没有这方面的意思。<br  /></div><div>这个公司最不满意的是就是这个IT和这种实习方式。对学校的合作感觉没什么好的，不如自己去找实习</div><note_content></note_content></div></div><a name="_16"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>7.29 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年7月29日(星期一) 中午01:07</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div style=""><font color="#4d4d4d" face="Microsoft YaHei, SF Pro Display, Roboto, Noto, Arial, PingFang SC, sans-serif"><span style="font-size: 16px; font-variant-ligatures: common-ligatures;">今天一天的时间主要是看ilitek_main.c和ilitek_platform_init.c两个函数。</span></font></div><div style=""><font color="#4d4d4d" face="Microsoft YaHei, SF Pro Display, Roboto, Noto, Arial, PingFang SC, sans-serif"><span style="font-size: 16px; font-variant-ligatures: common-ligatures;">并依据惠姐给的建议大致看了，并在函数里做些备注。自己也总结了一些.</span></font></div><div style=""><font color="#4d4d4d" face="Microsoft YaHei, SF Pro Display, Roboto, Noto, Arial, PingFang SC, sans-serif"><span style="font-size: 16px; font-variant-ligatures: common-ligatures;">现在感觉可能的还是下面的第一个这个问题这些（</span></font><span style=" color: rgb(77, 77, 77) ; ; ; ; ; ; ; ; ; ">touch模块所需的电/中断/I2C信号</span><span style=" font-size: 16px; font-variant-ligatures: common-ligatures; color: rgb(77, 77, 77) ; ; ; ; ; ; ; ">）比较困难。</span></div><div style=""><font color="#4d4d4d" face="Microsoft YaHei, SF Pro Display, Roboto, Noto, Arial, PingFang SC, sans-serif"><span style="font-size: 16px; font-variant-ligatures: common-ligatures;">惠姐帮忙解释一下bring up这个意思。是不是驱动（注册、匹配）这个流程？</span></font></div><div style=""><font color="#4d4d4d" face="Microsoft YaHei, SF Pro Display, Roboto, Noto, Arial, PingFang SC, sans-serif"><span style="font-size: 16px; font-variant-ligatures: common-ligatures;"><br  /></span></font></div><div style=""><font color="#4d4d4d" face="Microsoft YaHei, SF Pro Display, Roboto, Noto, Arial, PingFang SC, sans-serif"><span style="font-size: 16px; font-variant-ligatures: common-ligatures;">下面是一个简单的总结：</span></font></div><div style=""><font color="#4d4d4d" face="Microsoft YaHei, SF Pro Display, Roboto, Noto, Arial, PingFang SC, sans-serif"><span style="font-size: 16px; font-variant-ligatures: common-ligatures;"><div style="">1.原理图要看懂，touch模块所需的电/中断/I2C信号，要搞清楚是从哪里过来的</div><div style="">&nbsp; 这个还不怎么清楚，主要是这些函数之间的联系还有些模糊。</div><div style="">2.I2C模块的加载流程</div><div style="">（<a href="https://blog.csdn.net/zhangbijun1230/article/details/80796707" style="font-family: Verdana; font-size: 14px; font-variant-ligatures: normal;">https://blog.csdn.net/zhangbijun1230/article/details/80796707</a>）：一个很好的例子</div></span></font><font color="#4d4d4d" face="Microsoft YaHei, SF Pro Display, Roboto, Noto, Arial, PingFang SC, sans-serif"><span style="font-size: 16px; font-variant-ligatures: common-ligatures;"><div style="">3.DTS的使用，如何实现touch的相关配置</div><div style="">&nbsp; (主要是嵌套在各个函数，出发点是probe函数）</div><div style="">4.GPIO的申请/使用</div><div style="">&nbsp; main_probe()-&gt;ilitek_request_gpio(void)-&gt;ilitek_gpio_num()从设备树dts中获取gpio号</div><div style="">-&gt;gpio_request()向内核申请</div><div style="">gpio_direction_input/gpio_direction_output: 接口用来设置GPIO为输入/输出模式</div><div style="">5.regulator的申请/使用</div><div style="">&nbsp; main_probe()-&gt;ilitek_power_on()-&gt;regulator_enable()|regulator_disable()</div><div style="">6.中断的申请/使用</div><div style="">&nbsp; main_probe()-&gt;ilitek_request_irq()</div><div style="">7.bring up流程（文档中有介绍）</div><div style="">8.input子系统，如何上报数据</div><div style="">&nbsp; irqreturn_t ilitek_i2c_isr()-&gt; ilitek_i2c_process_and_report()-&gt;ilitek_read_data_and_report_3XX(void)-&gt;input_report_key(....)-&gt;ilitek_irq_enable()<br  /></div><div style=""><br  /></div><div style="">晚上又去领了快递，热的冒汗。之后又在自己的Ubuntu上配置python和django所需要的一些东西，但是就是在实现的时候，打不开所要实现的网址。自己的Ubuntu又卡得要命，真的好无奈啊。</div></span></font></div><div style=""></div><note_content></note_content></div></div><a name="_15"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>7.26 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年7月26日(星期五) 下午05:58</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div>今天早上主要是看了惠姐发的那个专门介绍各个文件有什么作用的pdf，英语不怎么好，就百度翻译一些。</div><div>下午主要是根据上午看的pdf看了几个文件，大致看了一遍里面的代码。有些难的就是那些缩写的英文单词具体的意思，（比如ESD（网上有点介绍）、DMA（是指DMA方式，还是其他）、还有一些结构体或者函数带（tpd、upd））。</div><div>后面又根据惠姐给的建议，分条上网搜了每个部分的流程和有什么作用，还发现了一个整理的很好的关于这方面的博客主。自己也大致看了相关的部分。</div><div>看原理图，只看明白一些，(touch模块所需的电/中断/I2C信号，要搞清楚是从哪里过来的)这个在dts文件里，怎么和那些芯片及原理图怎么联系起来还在不怎么清楚。</div><div>这些问题等下周在仔细看看，应该能够解决吧。下周计划按照惠姐的建议分别去那些函数里找找具体在哪里，然后在加深理解。</div><note_content></note_content></div></div><a name="_14"></a><div class="qqshowbd"><div class="notetitle bigfont"><b>7.12 实习日报</b></div><div class="graytext timesep"><span>创建时间：2019年7月26日(星期五) 中午01:03</span>&nbsp;|&nbsp;分类：日记 </div><div id="content" class="bigfont mycontent"><note_content></note_content><div><div>今天早上与公交车擦肩而过，与平常不同。让我们等了很长时间。差一点我们就打车了。</div><div>今天也是感觉很累一天，下午两三点特别困，差点睡着了。</div><div>今天感觉自己也没有做多少东西，就是继续理解bts相关的内容。下午还重新做了一遍git，但是没有成功过。此外又重新看了mkfile。接着也看了java。不过感觉自己一点也不踏实。</div><div>看了，就像没有看一样，还是那句话，需要实践与理解。</div><div>丁老师也向我们介绍了扳机的构造以及说下周可能让我们用命令控制扳机的开关。这个也解决了自己困的继续。</div><div>快下班，感觉今天有点累，体不上精神。就早早写了日志交了。感觉也没什么写的。不像现在写的嗦嗦。今天也下雨，回来都是淋雨的。本来想带伞的，怪自己嫌麻烦就没有，结果回来就成落汤鸡。不过还好，我们回来的早。我也匆忙的去食堂吃了饭。去超市买了洗衣服和小零食，不过现在也没多少了。现在发现自己也是个吃货。</div><div>后来就是自己开高速流量下了王者荣耀，本来不想玩的。但是发现自己好无聊，还是被自己打败了，信誉积分真的是一个垃圾的东西，让人烦，打了几局就睡觉了，到现在才醒。本来想继续睡，结果自己下来写日记的。有毒。</div><div>不过明天休息也是一件快乐的事情，不过星期天停电就很糟糕了。还有各种事要办就很烦了。</div></div><note_content></note_content></div></div></div>